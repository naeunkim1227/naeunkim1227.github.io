---
layout: post
title: [개념] Linux 내부구조
subtitle:
categories: Linux
tags: [Linux, 개념]
---


# Linux 내부구조

## 1.리눅스 파일시스템

### 1)파일시스템

1. 운영체제에서는 커널이미지, 시스템 실행과 관련된 시스템 파일 그리고 유틸리티 파일들을 제공한다.
2. 사용자의 데이터의 저장을 위해 사용됨
3. 디렉터리 안에 디렉터리를 저장할 수 있는 구조
4. 루트 디렉터리 : 장치의 메인 디렉토리
    1. 여러장치를 사용하면 루트 디렉터리 구분에 문제가 생긴다.
    2. 유닉스 계열에서는 통합형 파일시스템을 사용한다.



### 2)가상파일시스템(VFS)

- 유닉스는 디스크,터미널, 네트워크 카드등 모든 주변 장치들을 파일로 취급한다. 디스크상의 파일 시스템 외에도 다양한 기능의 특수 파일 시스템이 존재하는데 리눅스에서는 이러한 다양한 파일 시스템들을 하나의 파일 시스템처럼 사용할 수 있도록 가상 파일 시스템이라는 구조를 사용한다.
- 모든 파일 시스템을 하나의 파일 시스템으로 보이게 하는 계층이라 할 수 있다.
- 주요 특수 파일 시스템
    - procfs : 커널 및 커널 모듈 정보를 참조하거나, 설정 변경을 위한 파일 시스템, /proc에 마운트
    - syssfs : 시스템에 접속된 디바이스 정보를 참조하거나, 설정 변경을 위한 파일 시스템 , /sys 에 마운트
    - devfs : 물리 디바이스에 액세스 하기 위한 디바이스 파일을 배치하는 파일 시스템 , /dev 에 마운트


### 3)리눅스 디렉터리 구조

![리눅스 디렉터리 구조](https://user-images.githubusercontent.com/83413364/135374998-a91e25a9-6fc3-4ff3-b4c0-98bf5aed0c9e.png)


- 리눅스 배포판은 FHS 표준에 따르도록 권장한다.
- 각각의 디렉터리는 그에 맞는 용도가 있다.

1. / 루트
    
    : 모든 파티션, 디렉터리가 루트 디렉터리 아래에 존재한다.
    
2. bin
    
    :사용자가 실행 할 수 있는 명령어가 있음
    
3. sbin
    
    :시스템 관리자가 사용할 수 있는 명령어들이 들어 있다. 시스템 수정, 복구에 관한 명령어들이 있으며, 보안에 신경을 써야한다.
    
4. boot
    
    :부트로더와 부팅에 관련된 파일들
    
5. home
    
    :유저들의 홈디렉터리가 하위 디렉토리로 존재하게 된다.
    
6. dev
    
    :디바이스 파일들이 있다. 시스템의 모든 장치가 파일로 표현되어 있는데 udev라는 데몬이 이곳의 장치 파일을 관리한다.
    
7. etc
    
    :시스템 혹은 각종 프로그램들의 환경설정 파일들이 위치한다. 시스템 관리에서 이곳의 파일들을 주로 수정하게 된다. 백업해두는 것이 좋다.
    
8. lib
    
    :시스템의 프로그램이 실행 할 때 필요한 공유 라이브러리 들이 들어 있다. 변경,삭제하지 않는 것이 좋다.
    
9. mnt
    
    :마운트를 위한 임시 디렉토리가 위치한다.
    
10. root
    
    :root계정의 홈 디렉터리이다. root 홈 디렉터리는 root만 접근 할 수 있다.
    
11. var
    
    :log파일등 수시로 업데이트되는 파일들이 위치한다. 시스템 운영에 필요한 파일들도 위치하기 때문에 수정과 삭제에 주의 
    
12. proc
    
    :실행중인 프로세스 정보와 cpu,메모리등의 시스템 정보가 가상파일로 저장되어 있다.
    
13. /usr/bin
    
    :응용 프로그램들의 실행파일들이 위치
    
14. /usr/sbin
    
    :시스템 관리를 위한 명령어
    
15. /usr/include
    
    :시스템, 네트워크 프로그래밍을 위한 C헤더파일
    
16. /usr/lib
    
    :/usr/bin , /usr/sbin 에서 있는 실행 파일들을 위한 라이브러리들이 위치
    
17. tmp
    
    :임시로 파일을 만들고 삭제하는 공간
    
18. lost+found
    
    :부팅시 파일 시스템에 문제가 생길 경우 fsck명령어로 복구 할때 사용하는 디렉터리 
    

## 2.프로세스

### 1)프로세스

- 유닉스는 시분할 시스템으로 여러 개의 프로그램을 동시에 실행한다.(멀티태스킹)
- 컴퓨터 내에서 실행 중인 프로그램을 프로세스(process) 또는 태스크(Task)라고 한다.
- 여러 프로세스가 동시에 실행되는 것을 멀티프로세스라 한다.

### 2)프로세스 자료구조

### 3)프로세스 관리 명령어

1. ps [옵션] 
    - 옵션
    - ㅣ : 자세한 형태의 정보를 출력한다.
    - a : 다른 사용자들의 프로세스도 보여준다.
    - u : 프로세스의 사용자 이름과 시작 시가능 출력한다.
    - x : 터미널과 연결되지 않은 프로세스도 보여준다.
    - e : 환경을 보여준다.
    - f : 프로세스의 정보를 한 둘로 자세히 출력한다.
    - r : 현재 실행중인 프로세스들을 표시한다.
    - j : 작업 중심의 형태로 출력한다.
    - c : 커널 task_struct 구조체 형태로 보여준다.
    
    보통 **–aux**  또는 **–ef** 옵션을 사용해서 프로세스 상태를 확인한다.
    
- ps -ef 시 나오는 용어 해석
    - **USER:** 프로세스 소유자의 계정
    - **PID:** 프로세스를 구분하는 프로세스 아이디
    - **PPID:**  부모 프로세스 PID
    - **STIME**: 프로세스 시작 시간
    - **TTY:** 프로세스의 표준 입출력을 담당하는 터미널
    - **TIME:** 프로세스의 CPU 점유시간
    - **CMD:**실행 명령어
- 현재 실행되는 프로세스의 정보는 /proc 디렉토리를 통해서 확인 할 수 있다.
- 실행중인 프로세스에 대한 정보는 /proc 디렉토리안의 pid로 되어 있는 디렉토리에 존재하고 있으며 status 파일을 통해 확인 할 수 있다.
- ps > pid 확인 > cat /proc/pid번호/status
1. pstree 
    - 프로세스정보를 트리형태로 보여준다.
    - pstree [옵션]
        - n : PID 순으로 정렬
        - p : 프로세스 명 + PID
2. top
    - 프로세스의 cpu, 메모리 사용량등 전반적인 상황을 실시간으로 모니터링 한다.
    - top [옵션]
        - d 시간: 화면 갱신 시간 지정
        - c : 명령행 전체를 보여준다
        - q : 화면으 계속 갱신한다.
    - top명령 실행후 단축키
        - M: 메모리 사용량 순으로 정렬
        - P: CPU 사용량 순으로 정렬
        - T:  실행시간이 긴 순서로 정렬
        - R: 정렬의 순서 변경
3. kill
    - 지정한 프로세스에게 시그널을 보낸다.
    - kill [옵션] pid
    - 옵션 명령어
        - l : 시그널 목록을 보여준다.
        - c : 명령행 전체를 보여준다
        - q : 화면을 계속 갱신한다.
        - 1 : 애플리케이션 재초기화
        - 3: 애플리케이션 정상종료
        - 6: 프로그램 중단 알리고, 닫힘
        - 9: 강제 애플리케이션 종료

## 3.메모리관리

1. free
    - 시스템의 메모리 정보 출력
    - free  [옵션]
    - 옵션명령어
        - b : 바이트 단위 표시
        - k : Kb 단위로 표시
        - m : Mb 단위로 표시
        - t : 총합을 표시